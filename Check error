Option Explicit
Dim objShell, objExec, strExtractionScript, strOutput, blnErrorDetected

strExtractionScript = "C:\scripts\extraction.vbs" ' Spécifiez le chemin d'accès complet au fichier extraction.vbs
Set objShell = CreateObject("WScript.Shell")

' Exécutez le script d'extraction en tant que processus séparé
Set objExec = objShell.Exec("cscript.exe //NoLogo " & strExtractionScript)

strOutput = ""
blnErrorDetected = False

' Lisez la sortie d'erreur standard en temps réel et traitez les erreurs immédiatement lorsqu'elles sont détectées
Do While objExec.Status = 0 Or Not objExec.StdErr.AtEndOfStream
    If Not objExec.StdErr.AtEndOfStream Then
        strOutput = objExec.StdErr.ReadLine()
        WScript.Echo "Erreur détectée dans le script d'extraction : " & vbCrLf & strOutput
        blnErrorDetected = True
    End If
    WScript.Sleep 100
Loop

' Affichez un message si aucune erreur n'a été détectée
If Not blnErrorDetected Then
    WScript.Echo "Exécution du script d'extraction réussie, aucun code d'erreur."
End If
