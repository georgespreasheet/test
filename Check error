Option Explicit
Dim objShell, objExec, strExtractionScript, strOutput

strExtractionScript = "C:\scripts\extraction.vbs" ' Spécifiez le chemin d'accès complet au fichier extraction.vbs
Set objShell = CreateObject("WScript.Shell")

' Exécutez le script d'extraction en tant que processus séparé
Set objExec = objShell.Exec("cscript.exe //NoLogo " & strExtractionScript)

strOutput = ""

' Lisez la sortie d'erreur standard en temps réel et attendez que le script se termine
Do While objExec.Status = 0
    If Not objExec.StdErr.AtEndOfStream Then
        strOutput = strOutput & objExec.StdErr.ReadLine() & vbCrLf
    End If
    WScript.Sleep 100
Loop

' Vérifiez s'il y a des erreurs
If Len(strOutput) > 0 Then
    ' Insérez ici le code pour gérer l'erreur (par exemple, enregistrer l'erreur dans un fichier, envoyer un e-mail, etc.)
    WScript.Echo "Erreur détectée dans le script d'extraction : " & vbCrLf & strOutput
Else
    WScript.Echo "Exécution du script d'extraction réussie, aucun code d'erreur."
End If
